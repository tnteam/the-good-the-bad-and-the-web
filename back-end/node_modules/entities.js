/**
 * Created by rafik-naccache on 06/12/14.
 */
var _ = require('underscore')
function Entity (parameters){

    this.name = parameters.name;

    /**
     * Positions
     * @type {Number|*}
     */
    this.x = parameters.x;
    this.y = parameters.y;

    /**
     * Is server ?
     */
    this.is_serverp = parameters.is_serverp;
    this.is_server = function () {return this.is_serverp;};
    this.is_client = function () {return !this.is_serverp};

    /**
     * Is good ?
     */
    this.is_goodp = parameters.is_goodp;
    this.is_good = function() {
        return this.is_goodp;}
    this.is_bad = function(){
        return !this.is_goodp;}
    /*
     buy aptitude
     */


    this.aptitudes = parameters.aptitudes;

    /*
     add vulnerability
     remove vulnerability
     */
    this.vulnerabilities = parameters.vulnerabilities;


    /*
     webmana
     */
     this.webmana = parameters.webmana;
    this.his_player_id = parameters.his_player_id;
}

 Entity.prototype.incr_webmana = function(amount) {
     this.webmana+=amount;};

Entity.prototype.subst_webmana = function(amount) {
    this.webmana-=amount;};


Entity.prototype.buy_aptitude = function(bought_aptitude) {
    var exists = _.some(this.aptitudes,
        function(apt) {
            return (apt.name == bought_aptitude.name)});

    if (this.webmana >= bought_aptitude.price && !exists) {
        this.webmana-=bought_aptitude.price;
        this.aptitudes.push(bought_aptitude);
        return true;
    } else
        return false;
}

Entity.prototype.add_vulnerability = function(added_vuln) {
    var exists = _.some(this.vulnerabilities,
        function(vuln) {
            return (vuln.name == added_vuln.name)});
    if (exists) return false;

    this.vulnerabilities.push(added_vuln);
    return true;
}

Entity.prototype.move=function(x,y){this.x=x;this.y=y}



/**
 * connexion declaration
 */
function Connection (parameters) {
    this.name = parameters.name;
    this.source = parameters.source;
    this.target  = parameters.target;
}

/**
 * aptitude declaration
 */

function Aptitude (paramters) {
    this.name =paramters.name;
    this.description = paramters.description;
    this.price =paramters.price;
}

/**
 * vulnerability declaration
 */

function Vulnerability (parameters){
    this.name = parameters.name;
    this.description = parameters.description;
}

/**
 * Attack Object
 */






module.exports.Entity = Entity;
module.exports.Aptitude = Aptitude;
module.exports.Vulnerability = Vulnerability;

