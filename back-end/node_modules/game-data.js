/**
 * Created by rafik-naccache on 07/12/14.
 */

var entities = require('entities')
var utils = require('utils');
var _ = require('underscore');

/*
Specifying Aptitudes and Vulnerabilities by Hand, Time Time Time !!
 */


 function init_data() {


    this.possible_transactions = {}

    this.possible_attacks = {}

    this.possible_defenses = {}



    this.ssl_crypt = new entities.Aptitude({name:'ssl_crypt',description:'',price:2});
    this.ssl_decrypt = new entities.Aptitude({name:'ssl_decrypt',description:'',price:2});

    this.buy_stuff = new entities.Aptitude({name:'buy_stuff',description:'',price:2});
    this.sell_stuff = new entities.Aptitude({name:'sell_stuff',description:'',price:2});

    this.get_information = new entities.Aptitude({name:'get_information',description:'',price:2});
    this.give_information = new entities.Aptitude({name:'give_information',description:'',price:2});

    /*
    attacks vs vulnearabilities + defense
     */
    this.track_user = new entities.Aptitude({name:'track_user',description:'',price:3});
    this.user_w_cookies = new entities.Vulnerability({name:'user_w_cookies',description:''});
    this.use_non_tracing_services = new entities.Vulnerability({name:'user_use_non_tracing_services',
        description:'',price:20})

    this.steal_user_photos = new entities.Aptitude({name:'steal_user_photos',description:'',price:3});
    this.user_non_rights_aware = new entities.Vulnerability({name:'user_non_rights_aware',description:''});
    this.user_read_fine_prints = new entities.Aptitude({name:'user_read_fine_prints',description:'',price:5});

    this.exploit_user = new entities.Aptitude({name:'exploit_user',description:''});
    this.user_not_doing_updates = new entities.Vulnerability({name:'user_not_doing_update',description:''});
    this.user_updates_patches=new entities.Vulnerability({name:'user_updates_patches',description:'',price:2});

    this.steal_user_password = new entities.Aptitude({name:'steal_user_password',description:'',price: 2});
    this.user_using_weak_passwords = new entities.Vulnerability({name:'user_using_weak_passwords',description:''});
    this.user_use_two_factor_auth = new entities.Vulnerability({name:'user_use_two_factor_auth',description:'',
        price:4});


    this.steal_sensitive_data = new entities.Aptitude({name:'steal_sensitive_data',description:'',price:2});
    this.user_not_crypting_emails = new entities.Vulnerability({name:'user_not_crypting_emails', description:''});
    this.user_use_gpg=new entities.Vulnerability({name:'user_using_gpg',description:'',price: 2});


    this.possible_transactions[utils.hash_obj_tuple(this.ssl_crypt,this.ssl_decrypt)]={source:3,target:3};
    this.possible_transactions[utils.hash_obj_tuple(this.ssl_decrypt,this.ssl_crypt)]={source:3,target:3};

    this.possible_transactions[utils.hash_obj_tuple(this.buy_stuff,this.sell_stuff)]={source:3,target:3};
    this.possible_transactions[utils.hash_obj_tuple(this.sell_stuff,this.buy_stuff)]={source:3,target:3};


    this.possible_transactions[utils.hash_obj_tuple(this.get_information,this.give_information)] = {source:3,target:3};
    this.possible_transactions[utils.hash_obj_tuple(this.give_information,this.get_information)] = {source:3,target:3};

    this.possible_attacks[utils.hash_obj_tuple(this.track_user,this.user_w_cookies)] =  {source: 10, target: -2};
    this.possible_defenses[utils.hash_obj_tuple(this.track_user,this.use_non_tracing_services)] = {source:-15, target:10};

    this.possible_attacks[utils.hash_obj_tuple(this.steal_user_photos,this.user_non_rights_aware)] = {source:10,target: -2};
    this.possible_defenses[utils.hash_obj_tuple(this.steal_user_photos,this.user_read_fine_prints)] = {source:-15,target:10};

    this.possible_attacks[utils.hash_obj_tuple(this.exploit_user,this.user_not_doing_updates)]= {source:10,target:-20};
    this.possible_defenses[utils.hash_obj_tuple(this.exploit_user,this.user_updates_patches)]={source:-5,target:20};

    this.possible_attacks[utils.hash_obj_tuple(this.steal_user_password,this.user_using_weak_passwords)] = {source:20,target:-20};
    this.possible_defenses[utils.hash_obj_tuple(this.steal_user_password,this.user_use_two_factor_auth)] = {source:-5, target:30};

    this.possible_attacks[utils.hash_obj_tuple(this.steal_sensitive_data,this.user_not_crypting_emails)] = {source:20,target:-20};
    this.possible_defenses[utils.hash_obj_tuple(this.steal_sensitive_data,this.user_use_gpg)] = {source:-5,target:30};



}
init_data.prototype.all_vulnerabilities=  function()
{
   return(_.filter(_.values(this),function(v){return (v instanceof  entities.Vulnerability)}));
}

init_data.prototype.all_aptitudes = function()
{
      return(_.filter(_.values(this),function(v){return (v instanceof  entities.Aptitude)}));

}

//module.exports.utils.hash_obj_tuple = utils.hash_obj_tuple;
module.exports.init_data= init_data;

